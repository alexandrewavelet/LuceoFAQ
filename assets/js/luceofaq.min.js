function initModalQuestion(){$("#submitQuestion").unbind("click").click(saveQuestion),$("#addTagButton").unbind("click").click(addTagQuestion),$("#questionTagInput").unbind("keypress").keypress(function(a){13==a.which&&addTagQuestion()}),$(document).foundation()}function saveQuestion(){var a=$("#questionIdInput").val(),b=$("#questionLabelInput").val(),c=$("#questionAnswerInput").val();if(b&&c&&isInt(a)){var d=[];$(".tagElement").each(function(){d[d.length]={id:$(this).data("tagid"),name:$(this).data("tagname")}});var e=[];e[e.length]=a,e[e.length]=b,e[e.length]=c,e[e.length]=d;var f={phpclass:"QuestionActions",method:"saveQuestion",args:e};sendAjaxRequest(f,afterQuestionAdded,handleErrorPage)}else addErrorMessage('The fields "Question" and "Answer" are mandatory.',"#addQuestion");return!1}function addTagQuestion(){event.preventDefault();var a=$("#questionTagInput");if(""==a.val())return!1;if(a.val().length>20)return addErrorMessage("Tag lenght can't be more than 20 characters","#addQuestion"),a.val(""),!1;var b=constructTagElement(a.val());$("#tagsList").append(b),a.val("").focus(),initTagsEvents()}function initTagsEvents(){$(".tagElement").click(deleteTag).hover(function(){$(this).width($(this).width()),$(this).addClass("alert").text("Remove")},function(){$(this).removeClass("alert").text($(this).data("tagname"))})}function constructTagElement(a){var b='<span class="button tagElement" data-tagid="0" data-tagname="'+a+'">';return b+=a,b+="</span>"}function deleteTag(){$(this).remove()}function addErrorMessage(a,b){var c=constructAlertBox(a,"alert");appendAlertMessage(c,b)}function addSuccessMessage(a,b){var c=constructAlertBox(a,"success");appendAlertMessage(c,b)}function appendAlertMessage(a,b){$(b+" .alertBoxDiv").append(a),$(document).foundation()}function constructAlertBox(a,b){var c='<div data-alert class="alert-box '+b+'">';return c+=a,c+='<a href="#" class="close">&times;</a>',c+="</div>"}function sendAjaxRequest(a,b,c){b="undefined"==typeof b?"":b,c="undefined"==typeof c?handleErrorPage:c,$.ajax({method:"POST",url:"actions/ajaxactions.php",data:a,dataType:"json",success:function(a){a.error?"function"==typeof c&&c(a.message):"function"==typeof b&&b(a)},error:function(a,b,c){handleErrorPage("Something unexpected happened :("),console.log(b+" : "+c)}})}function afterQuestionAdded(a){console.log("Question id added : "+a.id),addSuccessMessage(a.message,"#alertPanePage"),$("#addQuestion").foundation("reveal","close")}function handleErrorPage(a){addErrorMessage(a,"#alertPanePage"),$("#addQuestion").foundation("reveal","close")}function isInt(a){return!isNaN(a)&&function(a){return(0|a)===a}(parseFloat(a))}$(document).foundation(),$(function(){$("#accordion").accordion({collapsible:!0,active:!1}),$(document).on("opened.fndtn.reveal","[data-reveal]",initModalQuestion)});